<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta name="follow.it-verification-code" content="&quot;zhuyYseGcwZBPEeDu2rJ"><title>Tag: Spring - Beyond the Blueprint</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Beyond the Blueprint"><meta name="msapplication-TileImage" content="/images/theme/logo.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Beyond the Blueprint"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Notes about Software Development and Engineering Managing"><meta property="og:type" content="blog"><meta property="og:title" content="Beyond the Blueprint"><meta property="og:url" content="https://lewandowski.io/"><meta property="og:site_name" content="Beyond the Blueprint"><meta property="og:description" content="Notes about Software Development and Engineering Managing"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://lewandowski.io/img/og_image.png"><meta property="article:author" content="Michał Lewandowski"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://lewandowski.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://lewandowski.io"},"headline":"Beyond the Blueprint","image":["https://lewandowski.io/img/og_image.png"],"author":{"@type":"Person","name":"Michał Lewandowski"},"publisher":{"@type":"Organization","name":"Beyond the Blueprint","logo":{"@type":"ImageObject","url":"https://lewandowski.io/images/theme/logo.png"}},"description":"Notes about Software Development and Engineering Managing"}</script><link rel="icon" href="/images/theme/logo.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-46SQQXSRX2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-46SQQXSRX2');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-1544756215319337" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Beyond the Blueprint" type="application/atom+xml">
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/theme/logo.png" alt="Beyond the Blueprint" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/mlevvy/mlevvy.github.io"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">Spring</a></li></ul></nav></div></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2016/02/formatting-java-time-with-spring-boot-using-json/"><img class="fill" src="/images/blog/stf1-thumbnail.jpg" alt="Formatting Java Time with Spring Boot using JSON"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2016-02-03T19:00:00.000Z" title="2/3/2016, 8:00:00 PM">2016-02-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">7 minutes read (About 1034 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2016/02/formatting-java-time-with-spring-boot-using-json/">Formatting Java Time with Spring Boot using JSON</a></p><div class="content"><p><strong>The aim of this post is to summarize and review ways of formatting Java Time objects using Spring Boot and Jackson library.</strong></p>
<p>This post is organized in five steps. Each step represents one aspect of the issue and it is also related to one commit in example project repository.</p>
<h2 id="Step-0-Prerequirements"><a href="#Step-0-Prerequirements" class="headerlink" title="Step 0 - Prerequirements"></a>Step 0 - Prerequirements</h2><h3 id="Versions-and-dependencies"><a href="#Versions-and-dependencies" class="headerlink" title="Versions and dependencies"></a>Versions and dependencies</h3><p>This tutorial is based on <code>Spring Boot</code> version <code>1.3.1.RELEASE</code> with <code>spring-boot-starter-web</code>. It uses <code>jackson-datatype-jsr310</code> from <code>com.fasterxml.jackson.datatype</code> in version <code>2.6.4</code>, which is a default version of <code>Spring Boot</code>. All of these is based on Java 8.</p>
<h3 id="The-Code"><a href="#The-Code" class="headerlink" title="The Code"></a>The Code</h3><p>In the example <a target="_blank" rel="noopener" href="https://github.com/mlevvy/spring-boot-json-dates">code repository</a>, you can find one HTTP service made with <code>Spring Boot</code>. This service is a <code>GET</code> operation, which returns a class with Java Time objects.<br>You can also find the integration test that deserializes the response.</p>
<h2 id="Step-1-The-goal"><a href="#Step-1-The-goal" class="headerlink" title="Step 1 - The goal"></a>Step 1 - The goal</h2><p>I would like to return class <code>Clock</code>, containing <code>LocalDate</code>,<code>LocalTime</code> and <code>LocalDateTime</code>, preinitialized in constructor.</p>
<figure class="highlight java"><figcaption><span>Clock - Service response class</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Clock</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LocalDate localDate;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LocalTime localTime;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LocalDateTime localDateTime;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Response class is serialized to JSON Map, which is a default behaviour. To some extent it is correct, but ISO formatted Strings in response are preferable.</p>
<figure class="highlight json"><figcaption><span>LocalDate - response as JSON Map</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">   <span class="attr">&quot;localDate&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span>  </span><br><span class="line">      <span class="attr">&quot;year&quot;</span><span class="punctuation">:</span><span class="number">2016</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;month&quot;</span><span class="punctuation">:</span><span class="string">&quot;JANUARY&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;era&quot;</span><span class="punctuation">:</span><span class="string">&quot;CE&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayOfYear&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayOfWeek&quot;</span><span class="punctuation">:</span><span class="string">&quot;FRIDAY&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;leapYear&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayOfMonth&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;monthValue&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;chronology&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span>  </span><br><span class="line">         <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;ISO&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;calendarType&quot;</span><span class="punctuation">:</span><span class="string">&quot;iso8601&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">   <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Integration testing is an appropriate way to test our functionality.</p>
<figure class="highlight java"><figcaption><span>Example of integration test</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ResponseEntity&lt;Clock&gt; resp = sut.getForEntity(<span class="string">&quot;http://localhost:8080/clock&quot;</span>, Clock.class);</span><br><span class="line"></span><br><span class="line">assertEquals(OK, resp.getStatusCode());</span><br><span class="line">assertEquals(c.getLocalDate(), resp.getBody().getLocalDate());</span><br><span class="line">assertEquals(c.getLocalTime(), resp.getBody().getLocalTime());</span><br><span class="line">assertEquals(c.getLocalDateTime(), resp.getBody().getLocalDateTime());</span><br></pre></td></tr></table></figure>

<p>Unfortunately, tests are not passing, because of deserialization problems. The exception with message is thrown <code>can not instantiate from JSON object</code>.</p>
<h2 id="Step-2-Adds-serialization"><a href="#Step-2-Adds-serialization" class="headerlink" title="Step 2 - Adds serialization"></a>Step 2 - Adds serialization</h2><p>First things first. We have to add JSR-310 module. It is a datatype module to make <a target="_blank" rel="noopener" href="http://jackson.codehaus.org/">Jackson</a> recognize Java 8 Date &amp; Time API data types.</p>
<p>Note that in this example <code>jackson-datatype-jsr310</code> version is inherited from <code>spring-boot-dependencies</code> dependency management.</p>
<figure class="highlight xml"><figcaption><span>Dependency in pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.datatype<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-datatype-jsr310<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Response is now consistent but still, not perfect. Dates are serialized as numbers:</p>
<figure class="highlight json"><figcaption><span>Dates serialized to numbers and integers</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">   <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDate&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span>  </span><br><span class="line">      <span class="number">2016</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">1</span></span><br><span class="line">   <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localTime&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span>  </span><br><span class="line">      <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">24</span></span><br><span class="line">   <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDateTime&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span>  </span><br><span class="line">      <span class="number">2016</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">24</span></span><br><span class="line">   <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;zonedDateTime&quot;</span><span class="punctuation">:</span><span class="number">1451640240.000000000</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>We are one step closer to our goal. Tests are passing now because this format can deserialized without any additional deserializers.<br>How do I know?<br>Start an application server on commit <code>Step 2 - Adds Object Mapper</code>, then checkout to <code>Step 1 - Introduce types and problems</code>, and run integration tests without <code>@WebIntegrationTest</code> annotation.</p>
<h2 id="Step-3-Enables-ISO-formatting"><a href="#Step-3-Enables-ISO-formatting" class="headerlink" title="Step 3 - Enables ISO formatting"></a>Step 3 - Enables ISO formatting</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> formatting is a standard. I’ve found it in many projects. We are going to enable and use it.<br>Edit spring boot properties file <code>application.properties</code> and add the following line:</p>
<figure class="highlight bash"><figcaption><span>application.properties file - disabling timestamps write</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.jackson.serialization.WRITE_DATES_AS_TIMESTAMPS = <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>Now, the response is something that I’ve expected:</p>
<figure class="highlight json"><figcaption><span>Dates serialized as Strings</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">   <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDate&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;10:24&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01T10:24&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;zonedDateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01T10:24:00+01:00&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Step-4-Adds-on-demand-formatting-pattern"><a href="#Step-4-Adds-on-demand-formatting-pattern" class="headerlink" title="Step 4 - Adds on demand formatting pattern"></a>Step 4 - Adds on demand formatting pattern</h2><p>Imagine one of your client systems does not have a capability of formatting time. It may be a primitive device, or microservice that treats this date as a collection of characters. That is why special formatting is required.  </p>
<p>We can change formatting in response class by adding <code>JsonFormat</code> annotation with pattern parameter. Standard <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a> rules apply.</p>
<figure class="highlight java"><figcaption><span>Using @JsonFormat annotation</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern = &quot;dd::MM::yyyy&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> LocalDate localDate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@JsonFormat(pattern = &quot;KK:mm a&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> LocalTime localTime;</span><br></pre></td></tr></table></figure>
<p>Below there is a service response using custom <code>@JsonFormat</code> pattern:</p>
<figure class="highlight json"><figcaption><span>Custom response style</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">   <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDate&quot;</span><span class="punctuation">:</span><span class="string">&quot;01::01::2016&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;10:24 AM&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01T10:24&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;zonedDateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01T10:24:00+01:00&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>Our tests are still passing. It means that this pattern is used for serialization in service and deserialization in tests.</p>
<h2 id="Step-5-Globally-changes-formatting"><a href="#Step-5-Globally-changes-formatting" class="headerlink" title="Step 5 - Globally changes formatting"></a>Step 5 - Globally changes formatting</h2><p>There are situations where you have to resign from <code>ISO 8601</code> formatting in your whole application, and apply custom made standards. </p>
<p>In this part, we will redefine format pattern for LocalDate. This will change formatting of LocalDate in <strong>every endpoint</strong> of your API.</p>
<p>We have to define:</p>
<ul>
<li><code>DateTimeFormatter</code> with our pattern.</li>
<li><code>Serializer</code> using defined pattern.</li>
<li><code>Deserializer</code> using defined pattern.</li>
<li><code>ObjectMapper</code> bean with custom serializer and deserializer.</li>
<li><code>RestTemplate</code> that uses our <code>ObjectMapper</code>.</li>
</ul>
<p>Bean ObjectMapper is defined with annotation <code>@Primary</code>, to override default configuration.<br>My custom pattern for <code>LocalDate</code> is <code>dd::MM::yyyy</code></p>
<figure class="highlight java"><figcaption><span>Object mapper bean with custom pattern</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">DateTimeFormatter</span> <span class="variable">FORMATTER</span> <span class="operator">=</span> ofPattern(<span class="string">&quot;dd::MM::yyyy&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="keyword">public</span> ObjectMapper <span class="title function_">serializingObjectMapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">    <span class="type">JavaTimeModule</span> <span class="variable">javaTimeModule</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JavaTimeModule</span>();</span><br><span class="line">    javaTimeModule.addSerializer(LocalDate.class, <span class="keyword">new</span> <span class="title class_">LocalDateSerializer</span>());</span><br><span class="line">    javaTimeModule.addDeserializer(LocalDate.class, <span class="keyword">new</span> <span class="title class_">LocalDateDeserializer</span>());</span><br><span class="line">    objectMapper.registerModule(javaTimeModule);</span><br><span class="line">    <span class="keyword">return</span> objectMapper;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Definitions of serializer and deserializer for all LocalDate classes:</p>
<figure class="highlight java"><figcaption><span>Custom serializer and deserializer</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalDateSerializer</span> <span class="keyword">extends</span> <span class="title class_">JsonSerializer</span>&lt;LocalDate&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(LocalDate value, JsonGenerator gen, SerializerProvider serializers)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        gen.writeString(value.format(FORMATTER));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalDateDeserializer</span> <span class="keyword">extends</span> <span class="title class_">JsonDeserializer</span>&lt;LocalDate&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> LocalDate <span class="title function_">deserialize</span><span class="params">(JsonParser p, DeserializationContext ctxt)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">return</span> LocalDate.parse(p.getValueAsString(), FORMATTER);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now, the response is formatted with our custom pattern:</p>
<figure class="highlight java"><figcaption><span>Formatted response</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;  </span><br><span class="line">   <span class="string">&quot;localDate&quot;</span>:<span class="string">&quot;01::01::2016&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Tests"><a href="#Tests" class="headerlink" title="Tests"></a>Tests</h3><p>When we define custom serializer, our tests start to fail. It is because RestTemplate knows nothing about our deserializer. We have to create custom RestTemplateFactory that creates RestTemplate with object mapper containing our deserializer.</p>
<figure class="highlight java"><figcaption><span>Custom RestTemplateFactory</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ObjectMapper objectMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">createRestTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">RestTemplate</span> <span class="variable">restTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">        List&lt;HttpMessageConverter&lt;?&gt;&gt; converters = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">MappingJackson2HttpMessageConverter</span> <span class="variable">jsonConverter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>();</span><br><span class="line">        jsonConverter.setObjectMapper(objectMapper);</span><br><span class="line">        converters.add(jsonConverter);</span><br><span class="line">        restTemplate.setMessageConverters(converters);</span><br><span class="line">        <span class="keyword">return</span> restTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Custom formatting Dates is relatively simple, but you have to know how to set up it. Luckily, <code>Jackson</code> works smoothly with <code>Spring</code>. If you know other ways of solving this problem or you have other observations, please comment or let me know.</p>
<p>Photo credits: <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/19511776@N00/286814746">Banner</a>, <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/49968232@N00/2474880917">Thumbnail</a></p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/theme/logo.png" alt="Michał Lewandowski"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Michał Lewandowski</p><p class="is-size-6 is-block">Engineering Manager</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Europe, Warsaw Poland</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">40</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">44</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://www.linkedin.com/in/lewandowski-io/" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/mlevvy"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/lewandowski.michal/"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/lewandm4"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/lewandowski-io/"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Book/"><span class="level-start"><span class="level-item">Book</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Event/"><span class="level-start"><span class="level-item">Event</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Software-Development/"><span class="level-start"><span class="level-item">Software Development</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Technology/"><span class="level-start"><span class="level-item">Technology</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Agile/"><span class="tag">Agile</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OS-X/"><span class="tag">OS X</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Management/"><span class="tag">Management</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Devoxx/"><span class="tag">Devoxx</span><span class="tag">2</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="https://api.follow.it/subscription-form/SCtIS1IzbmIzZjVnTjhYb1p5VDFDajBxWkhVakxja1NkTFNjejYxR1BoMWw0aGloSTMxRThrd0ZRRzFpRFBkQXRqYWVyWko1Y3Q2cExzUkdxMDgvbUxDelhDS0lpK3AyVnllK21MVXRFWC84ZXo5KzYvZUN3bzFoRThrUnZFdnJ8Rm9CT25jaXpobHJZS0NJRXVQdDBPcnJMUE82YlM3MVE1eEhEVk5oOGRCND0=/8" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-20T14:48:22.000Z">2023-08-20</time></p><p class="title"><a href="/2023/08/output-vs-outcome/">Outcome vs Output in Software Engineering - A Critical Balance</a></p><p class="categories"><a href="/categories/Software-Development/">Software Development</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-04-03T09:00:00.000Z">2020-04-03</time></p><p class="title"><a href="/2020/04/se-roadmap/">Software Engineer Checklist</a></p><p class="categories"><a href="/categories/Software-Development/">Software Development</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-01-21T19:46:00.000Z">2020-01-21</time></p><p class="title"><a href="/2020/01/best-books-in-2019/">Two best books in 2019</a></p><p class="categories"><a href="/categories/Book/">Book</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-01-25T14:46:00.000Z">2019-01-25</time></p><p class="title"><a href="/2019/01/agile-it-organization-design/">Agile IT Organization Design</a></p><p class="categories"><a href="/categories/Book/">Book</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2017-02-05T16:06:23.000Z">2017-02-05</time></p><p class="title"><a href="/2017/02/thre-levels-of-tdd-1/">Three levels of TDD</a></p><p class="categories"><a href="/categories/Software-Development/">Software Development</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/"><span class="level-start"><span class="level-item">2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/"><span class="level-start"><span class="level-item">2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/"><span class="level-start"><span class="level-item">2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/"><span class="level-start"><span class="level-item">2016</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/"><span class="level-start"><span class="level-item">2015</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/"><span class="level-start"><span class="level-item">2014</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/"><span class="level-start"><span class="level-item">2013</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/"><span class="level-start"><span class="level-item">2012</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2011/"><span class="level-start"><span class="level-item">2011</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1544756215319337" data-ad-slot="1495263777" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/theme/logo.png" alt="Beyond the Blueprint" height="28"></a><p class="is-size-7"><span>&copy; 2023 Michał Lewandowski</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>