<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta name="follow.it-verification-code" content="&quot;zhuyYseGcwZBPEeDu2rJ"><title>Category: Software Development - Beyond the Blueprint</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Beyond the Blueprint"><meta name="msapplication-TileImage" content="/images/theme/logo.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Beyond the Blueprint"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Notes about Software Development and Engineering Managing"><meta property="og:type" content="blog"><meta property="og:title" content="Beyond the Blueprint"><meta property="og:url" content="https://lewandowski.io/"><meta property="og:site_name" content="Beyond the Blueprint"><meta property="og:description" content="Notes about Software Development and Engineering Managing"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://lewandowski.io/img/og_image.png"><meta property="article:author" content="Michał Lewandowski"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://lewandowski.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://lewandowski.io"},"headline":"Beyond the Blueprint","image":["https://lewandowski.io/img/og_image.png"],"author":{"@type":"Person","name":"Michał Lewandowski"},"publisher":{"@type":"Organization","name":"Beyond the Blueprint","logo":{"@type":"ImageObject","url":"https://lewandowski.io/images/theme/logo.png"}},"description":"Notes about Software Development and Engineering Managing"}</script><link rel="icon" href="/images/theme/logo.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-46SQQXSRX2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-46SQQXSRX2');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-1544756215319337" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Beyond the Blueprint" type="application/atom+xml">
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/theme/logo.png" alt="Beyond the Blueprint" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/mlevvy/mlevvy.github.io"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">Categories</a></li><li class="is-active"><a href="#" aria-current="page">Software Development</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-01-03T13:00:00.000Z" title="1/3/2024, 2:00:00 PM">2024-01-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">16 minutes read (About 2400 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/01/7-levels-of-initives/">Unlocking Team Potential - The 7 Levels of Initiative</a></p><div class="content"><p>In our world of engineering management, a big question arises: “What is the best reward for an Engineering Manager?” People have many different answers to this. For me, the best reward is seeing my team grow and do well on their own.</p>
<p>Think about a day at work when your team is full of energy and ideas. They solve problems quickly and work well together. And you? You’re helping them succeed and focusing on the big picture. Your job isn’t just about managing; it’s about leading in a new way.</p>
<p>So, how do we make this happen? How do we unite a group to form a strong team that does better than we ever hoped? The answer is in encouraging initiative.</p>
<p>In this blog post, I’ll discuss the 7 Levels of Initiative, an idea from Steven Covey’s research. It’s not just a way to check how well the manager is doing in the team; it’s about helping our teams be their best.</p></div><a class="article-more button is-small is-size-7" href="/2024/01/7-levels-of-initives/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-10-03T17:16:17.000Z" title="10/3/2023, 7:16:17 PM">2023-10-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">16 minutes read (About 2347 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/communication-written/">The Engineering Manager&#039;s 10-Step Blueprint for Effective Written Communication</a></p><div class="content"><p><strong>Effective communication is pivotal in engineering management. This blog aims to dissect the intricacies of written communication, offering insights and practical tools to enhance your interactions.</strong></p>
<p>While I’m no Shakespeare, writing gives me a sense of clarity. It’s a medium where I can truly articulate my thoughts and share knowledge. But let’s face it, written communication has its challenges—no facial expressions, no tone, just words on a screen. Understanding this gap is crucial for effective communication. This blog post aims to dig into the complexities of written communication, offering you a detailed roadmap for improvement. </p>
<p>Whether you’re drafting an extensive project plan or shooting off a quick Slack message to your team, the principles outlined in this blog can elevate your written communication across all platforms.”</p>
<p>Why written communication is challenging?<br> In verbal communication, tone, pitch, and facial expressions play a significant role in delivering your message. These non-verbal cues can help clarify meaning, show emotion, and give nuance to what you’re saying. Written communication lacks these elements. Words on a screen don’t carry tone or facial expressions, making it easier for the message to be misinterpreted. For instance, what you write with a positive intent could come across as neutral or even negative to the reader.</p></div><a class="article-more button is-small is-size-7" href="/2023/10/communication-written/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-08-20T14:48:22.000Z" title="8/20/2023, 4:48:22 PM">2023-08-20</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">7 minutes read (About 1038 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/08/output-vs-outcome/">Outcome vs Output in Software Engineering - A Critical Balance</a></p><div class="content"><p><strong>Imagine a skilled craftsman meticulously building a wooden chair. The finished chair, sturdy and polished, is the output. But if nobody finds the chair comfortable, the intended outcome, a satisfying seating experience, is not achieved.</strong></p>
<p>This simple example from carpentry resonates deeply with the complex world of software engineering. Have you ever heard of o Software Engineer who does not like to be named Craftsman? The nuance between outcome and output is not philosophical and has profound practical implications. As software engineers, focusing on both aspects can lead to projects that are not only technically sound but also aligned with user needs and business goals.</p></div><a class="article-more button is-small is-size-7" href="/2023/08/output-vs-outcome/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-04-03T09:00:00.000Z" title="4/3/2020, 11:00:00 AM">2020-04-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">25 minutes read (About 3806 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/04/se-roadmap/">Software Engineer Checklist</a></p><div class="content"><p><strong>When I started my career as a software engineer, I didn’t have any map or list of skills that are necessary to succeed. I’ve spent too much time on unimportant stuff, a far too little on crucial things. If you know at least something about software development - you can create web service in Django, or build microservice in Spring, crate some machine learning model, or write Spark Job - and you want to advance your career to the next level, this blog post might be helpful for you.</strong></p>
<p>Before we start, I have good and bad news.<br>The good news is that at some point you will have to unlearn what you have learned. If you learn something, you are becoming blind to other things that you can learn. Remember, you are a creative person; your mind should be free and open for new waters. Do not be afraid to forget stuff.</p>
<p>The bad news is that you will probably never stop learning.<br>Over time, some things became similar, and we use similar design patterns in different contexts. Even that something is similar, it is not an excuse to stop learning. You need thousands of hours of practice and writing software to be good at it. Besides spending many years writing software, I know that I have deficiencies in some areas that I want to improve.</p></div><a class="article-more button is-small is-size-7" href="/2020/04/se-roadmap/#more">Read more</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2017-02-05T16:06:23.000Z" title="2/5/2017, 5:06:23 PM">2017-02-05</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">6 minutes read (About 832 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/02/thre-levels-of-tdd-1/">Three levels of TDD</a></p><div class="content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>I’ve been using TDD technique for a few years. Most of the time with satisfactory a result. But it wasn’t an easy journey; it was a trip full of ups and downs. During this period my thinking about TDD has changed dramatically, or maybe I have changed my perception of testing and software development during this time? Indeed, yes I have.</p>
<p>Lasse Koskela in his book called “Test Driven: TDD and Acceptance TDD for Java Developers.” wrote that “TDD is a technique that evolves together with the practitioner.” In this blog post, I would like to describe my own evolution in this matter.</p>
<p><img src="/images/tdd_flow.gif" alt="Red Green Refactor Circle"></p>
<h2 id="Level-1-Fundamentals"><a href="#Level-1-Fundamentals" class="headerlink" title="Level 1 - Fundamentals"></a>Level 1 - Fundamentals</h2><p>You begin your journey with TDD. When you are new into something, you want to follow the rules strictly. One is TDD circle, which is “RED, GREEN, REFACTOR”. You have also heard about <a target="_blank" rel="noopener" href="http://butunclebob.com/ArticleS.UncleBob.TheThreeRulesOfTdd">three laws of TDD</a> defined by Uncle Bob:</p>
<ul>
<li>You are not allowed to write any production code unless it is to make a failing unit test pass.</li>
<li>You are not allowed to write any more of a unit test than is sufficient to fail, and compilation failures are failures.</li>
<li>You are not allowed to write any more production code than is sufficient to pass the one failing unit test.</li>
</ul>
<p>You are very confused about TDD because all examples that you can find relate to some mathematical&#x2F;algorithmic problems. But in your daily job, you are obligated to write features, talk to DB and the other systems. You probably are struggling with complex dependencies, maybe you have to use mocks.</p>
<p>But finally, after some practice you start to see the benefits, which are:</p>
<ul>
<li>You’ve noticed short feedback loop. Immediately, when you complete your implementation, you can launch the test to verify the correctness of your code.</li>
<li>Test code coverage gets higher. No matter how you measure it, it will be higher.</li>
<li>Regression is not a problem. Because when you break previous functionality during refactoring, you will instantly know that.</li>
</ul>
<h2 id="Level-2-Requirements"><a href="#Level-2-Requirements" class="headerlink" title="Level 2 - Requirements"></a>Level 2 - Requirements</h2><h3 id="Task-lists"><a href="#Task-lists" class="headerlink" title="Task lists"></a>Task lists</h3><p>Task lists work perfectly for me. When I implement a business requirement, each small step or each corner case is represented by one task in my task list. </p>
<p>Then for each task I write one test, often I use parametrized tests to extend tests quickly. Finally, after a few TDD circles, my task is finally completed, and I can move on.</p>
<p>But sometimes during my work new system requirements appear. Often because the domain is so complicated that it’s hard to predict all the functionality up front. There is a big temptation to do it now, during the work on the current task, but it is dangerous. By doing it, you can lose your focus on your current goal. </p>
<p>I’ve practiced the habit which consists of adding this new requirement as a new task to my task list and complete it after the current one. Then you gain some time to think about this need, to decide if it is an essential functionality to do.</p>
<h3 id="BDD"><a href="#BDD" class="headerlink" title="BDD"></a>BDD</h3><p>At some day, you will discover Behaviour Driven Development. For example, look at this specification: </p>
<figure class="highlight plaintext"><figcaption><span>Scenario</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Scenario: Customer has a broker policy so DOB is requested</span><br><span class="line">  Given I have a &quot;Broker&quot; policy</span><br><span class="line">  When I submit my policy number</span><br><span class="line">  Then I should be asked for my date of birth</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>It is a very well written test scenario. Moreover, it is an executable scenario. This text can be executed with the tool called Cucumber. You don’t have to use it. You can use standard test framework and write your test using fluent test libraries or you can build your fluent API for tests if needed. </p>
<p>Start writing tests that will not only check your code but also be valuable documentation for your system. </p>
<h3 id="Level-3-Understanding"><a href="#Level-3-Understanding" class="headerlink" title="Level 3 - Understanding"></a>Level 3 - Understanding</h3><blockquote><p>Show me your tests and I will tell you everything about your code.</p>
</blockquote>
<p>TDD sometimes can also mean “Test Driven Design”. When you start thinking about it, your main reason for writing the tests is to refactor and re-engineer your codebase freely. For me, it is the highest value which you can get from TDD. How to achieve it? Try not to “cement” your code. Try to test interfaces or facades but not bolts and nuts of the implementation. </p>
<p>How to check if your tests are correct? Remove production code and try to rebuild it in a different way basing only on tests.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>In this article, I presented fundamental rules of TDD. The topic of requirements were also discussed. In the end, I told you about Test Driven Design which for me is a valuable part of this technique. I hope that your understanding of TDD will improve and you will start writing better tests and better systems.</p>
<p>I gave a speech about TDD. Slides available at <a target="_blank" rel="noopener" href="http://tdd.lewandowski.io/#/">tdd.lewandowski.io</a></p>
<p>Photo credits: <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/43851301@N02/9339188957">Banner, Thumbnail</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2016-10-23T15:23:00.000Z" title="10/23/2016, 5:23:00 PM">2016-10-23</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">a minute read (About 142 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2016/10/fish-env/">Fish shell - Load environment variables from file</a></p><div class="content"><p>In many places, you can find environment files, with the following structure:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FOO1=BAR1</span><br><span class="line">FOO2=BAR2</span><br></pre></td></tr></table></figure>

<p>When you try to evaluate, this file using <code>source</code> command, you get an error with the fish shell.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> web.env                                                   </span><br><span class="line">Unsupported use of <span class="string">&#x27;=&#x27;</span>. In fish, please use <span class="string">&#x27;set FOO1 BAR1&#x27;</span>.</span><br></pre></td></tr></table></figure>

<p>This is very annoying, so I’ve decided to write a function that can read this file and load those variables. Here is how you can use it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ posix-source web.env</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$FOO1</span></span><br><span class="line">BAR1</span><br></pre></td></tr></table></figure>

<p>The source code of this function. Enjoy:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> .config/fish/functions/posix-source.fish                      </span><br><span class="line"><span class="keyword">function</span> posix-source</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> (<span class="built_in">cat</span> <span class="variable">$argv</span>)</span><br><span class="line">		<span class="built_in">set</span> arr (<span class="built_in">echo</span> <span class="variable">$i</span> |<span class="built_in">tr</span> = \n)</span><br><span class="line">  		<span class="built_in">set</span> -gx <span class="variable">$arr</span>[1] <span class="variable">$arr</span>[2]</span><br><span class="line">	end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>Photo credits: <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/124790945@N06/26505253632">Banner, Thumbnail</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2016-02-03T19:00:00.000Z" title="2/3/2016, 8:00:00 PM">2016-02-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">7 minutes read (About 1034 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2016/02/formatting-java-time-with-spring-boot-using-json/">Formatting Java Time with Spring Boot using JSON</a></p><div class="content"><p><strong>The aim of this post is to summarize and review ways of formatting Java Time objects using Spring Boot and Jackson library.</strong></p>
<p>This post is organized in five steps. Each step represents one aspect of the issue and it is also related to one commit in example project repository.</p>
<h2 id="Step-0-Prerequirements"><a href="#Step-0-Prerequirements" class="headerlink" title="Step 0 - Prerequirements"></a>Step 0 - Prerequirements</h2><h3 id="Versions-and-dependencies"><a href="#Versions-and-dependencies" class="headerlink" title="Versions and dependencies"></a>Versions and dependencies</h3><p>This tutorial is based on <code>Spring Boot</code> version <code>1.3.1.RELEASE</code> with <code>spring-boot-starter-web</code>. It uses <code>jackson-datatype-jsr310</code> from <code>com.fasterxml.jackson.datatype</code> in version <code>2.6.4</code>, which is a default version of <code>Spring Boot</code>. All of these is based on Java 8.</p>
<h3 id="The-Code"><a href="#The-Code" class="headerlink" title="The Code"></a>The Code</h3><p>In the example <a target="_blank" rel="noopener" href="https://github.com/mlevvy/spring-boot-json-dates">code repository</a>, you can find one HTTP service made with <code>Spring Boot</code>. This service is a <code>GET</code> operation, which returns a class with Java Time objects.<br>You can also find the integration test that deserializes the response.</p>
<h2 id="Step-1-The-goal"><a href="#Step-1-The-goal" class="headerlink" title="Step 1 - The goal"></a>Step 1 - The goal</h2><p>I would like to return class <code>Clock</code>, containing <code>LocalDate</code>,<code>LocalTime</code> and <code>LocalDateTime</code>, preinitialized in constructor.</p>
<figure class="highlight java"><figcaption><span>Clock - Service response class</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Clock</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LocalDate localDate;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LocalTime localTime;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LocalDateTime localDateTime;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Response class is serialized to JSON Map, which is a default behaviour. To some extent it is correct, but ISO formatted Strings in response are preferable.</p>
<figure class="highlight json"><figcaption><span>LocalDate - response as JSON Map</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">   <span class="attr">&quot;localDate&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span>  </span><br><span class="line">      <span class="attr">&quot;year&quot;</span><span class="punctuation">:</span><span class="number">2016</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;month&quot;</span><span class="punctuation">:</span><span class="string">&quot;JANUARY&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;era&quot;</span><span class="punctuation">:</span><span class="string">&quot;CE&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayOfYear&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayOfWeek&quot;</span><span class="punctuation">:</span><span class="string">&quot;FRIDAY&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;leapYear&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;dayOfMonth&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;monthValue&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;chronology&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span>  </span><br><span class="line">         <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;ISO&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;calendarType&quot;</span><span class="punctuation">:</span><span class="string">&quot;iso8601&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">   <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Integration testing is an appropriate way to test our functionality.</p>
<figure class="highlight java"><figcaption><span>Example of integration test</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ResponseEntity&lt;Clock&gt; resp = sut.getForEntity(<span class="string">&quot;http://localhost:8080/clock&quot;</span>, Clock.class);</span><br><span class="line"></span><br><span class="line">assertEquals(OK, resp.getStatusCode());</span><br><span class="line">assertEquals(c.getLocalDate(), resp.getBody().getLocalDate());</span><br><span class="line">assertEquals(c.getLocalTime(), resp.getBody().getLocalTime());</span><br><span class="line">assertEquals(c.getLocalDateTime(), resp.getBody().getLocalDateTime());</span><br></pre></td></tr></table></figure>

<p>Unfortunately, tests are not passing, because of deserialization problems. The exception with message is thrown <code>can not instantiate from JSON object</code>.</p>
<h2 id="Step-2-Adds-serialization"><a href="#Step-2-Adds-serialization" class="headerlink" title="Step 2 - Adds serialization"></a>Step 2 - Adds serialization</h2><p>First things first. We have to add JSR-310 module. It is a datatype module to make <a target="_blank" rel="noopener" href="http://jackson.codehaus.org/">Jackson</a> recognize Java 8 Date &amp; Time API data types.</p>
<p>Note that in this example <code>jackson-datatype-jsr310</code> version is inherited from <code>spring-boot-dependencies</code> dependency management.</p>
<figure class="highlight xml"><figcaption><span>Dependency in pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.datatype<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-datatype-jsr310<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Response is now consistent but still, not perfect. Dates are serialized as numbers:</p>
<figure class="highlight json"><figcaption><span>Dates serialized to numbers and integers</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">   <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDate&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span>  </span><br><span class="line">      <span class="number">2016</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">1</span></span><br><span class="line">   <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localTime&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span>  </span><br><span class="line">      <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">24</span></span><br><span class="line">   <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDateTime&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span>  </span><br><span class="line">      <span class="number">2016</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">24</span></span><br><span class="line">   <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;zonedDateTime&quot;</span><span class="punctuation">:</span><span class="number">1451640240.000000000</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>We are one step closer to our goal. Tests are passing now because this format can deserialized without any additional deserializers.<br>How do I know?<br>Start an application server on commit <code>Step 2 - Adds Object Mapper</code>, then checkout to <code>Step 1 - Introduce types and problems</code>, and run integration tests without <code>@WebIntegrationTest</code> annotation.</p>
<h2 id="Step-3-Enables-ISO-formatting"><a href="#Step-3-Enables-ISO-formatting" class="headerlink" title="Step 3 - Enables ISO formatting"></a>Step 3 - Enables ISO formatting</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> formatting is a standard. I’ve found it in many projects. We are going to enable and use it.<br>Edit spring boot properties file <code>application.properties</code> and add the following line:</p>
<figure class="highlight bash"><figcaption><span>application.properties file - disabling timestamps write</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.jackson.serialization.WRITE_DATES_AS_TIMESTAMPS = <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>Now, the response is something that I’ve expected:</p>
<figure class="highlight json"><figcaption><span>Dates serialized as Strings</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">   <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDate&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;10:24&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01T10:24&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;zonedDateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01T10:24:00+01:00&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Step-4-Adds-on-demand-formatting-pattern"><a href="#Step-4-Adds-on-demand-formatting-pattern" class="headerlink" title="Step 4 - Adds on demand formatting pattern"></a>Step 4 - Adds on demand formatting pattern</h2><p>Imagine one of your client systems does not have a capability of formatting time. It may be a primitive device, or microservice that treats this date as a collection of characters. That is why special formatting is required.  </p>
<p>We can change formatting in response class by adding <code>JsonFormat</code> annotation with pattern parameter. Standard <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a> rules apply.</p>
<figure class="highlight java"><figcaption><span>Using @JsonFormat annotation</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern = &quot;dd::MM::yyyy&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> LocalDate localDate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@JsonFormat(pattern = &quot;KK:mm a&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> LocalTime localTime;</span><br></pre></td></tr></table></figure>
<p>Below there is a service response using custom <code>@JsonFormat</code> pattern:</p>
<figure class="highlight json"><figcaption><span>Custom response style</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line">   <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDate&quot;</span><span class="punctuation">:</span><span class="string">&quot;01::01::2016&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;10:24 AM&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;localDateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01T10:24&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;zonedDateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2016-01-01T10:24:00+01:00&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>Our tests are still passing. It means that this pattern is used for serialization in service and deserialization in tests.</p>
<h2 id="Step-5-Globally-changes-formatting"><a href="#Step-5-Globally-changes-formatting" class="headerlink" title="Step 5 - Globally changes formatting"></a>Step 5 - Globally changes formatting</h2><p>There are situations where you have to resign from <code>ISO 8601</code> formatting in your whole application, and apply custom made standards. </p>
<p>In this part, we will redefine format pattern for LocalDate. This will change formatting of LocalDate in <strong>every endpoint</strong> of your API.</p>
<p>We have to define:</p>
<ul>
<li><code>DateTimeFormatter</code> with our pattern.</li>
<li><code>Serializer</code> using defined pattern.</li>
<li><code>Deserializer</code> using defined pattern.</li>
<li><code>ObjectMapper</code> bean with custom serializer and deserializer.</li>
<li><code>RestTemplate</code> that uses our <code>ObjectMapper</code>.</li>
</ul>
<p>Bean ObjectMapper is defined with annotation <code>@Primary</code>, to override default configuration.<br>My custom pattern for <code>LocalDate</code> is <code>dd::MM::yyyy</code></p>
<figure class="highlight java"><figcaption><span>Object mapper bean with custom pattern</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">DateTimeFormatter</span> <span class="variable">FORMATTER</span> <span class="operator">=</span> ofPattern(<span class="string">&quot;dd::MM::yyyy&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="keyword">public</span> ObjectMapper <span class="title function_">serializingObjectMapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">    <span class="type">JavaTimeModule</span> <span class="variable">javaTimeModule</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JavaTimeModule</span>();</span><br><span class="line">    javaTimeModule.addSerializer(LocalDate.class, <span class="keyword">new</span> <span class="title class_">LocalDateSerializer</span>());</span><br><span class="line">    javaTimeModule.addDeserializer(LocalDate.class, <span class="keyword">new</span> <span class="title class_">LocalDateDeserializer</span>());</span><br><span class="line">    objectMapper.registerModule(javaTimeModule);</span><br><span class="line">    <span class="keyword">return</span> objectMapper;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Definitions of serializer and deserializer for all LocalDate classes:</p>
<figure class="highlight java"><figcaption><span>Custom serializer and deserializer</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalDateSerializer</span> <span class="keyword">extends</span> <span class="title class_">JsonSerializer</span>&lt;LocalDate&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(LocalDate value, JsonGenerator gen, SerializerProvider serializers)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        gen.writeString(value.format(FORMATTER));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalDateDeserializer</span> <span class="keyword">extends</span> <span class="title class_">JsonDeserializer</span>&lt;LocalDate&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> LocalDate <span class="title function_">deserialize</span><span class="params">(JsonParser p, DeserializationContext ctxt)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">return</span> LocalDate.parse(p.getValueAsString(), FORMATTER);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now, the response is formatted with our custom pattern:</p>
<figure class="highlight java"><figcaption><span>Formatted response</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;  </span><br><span class="line">   <span class="string">&quot;localDate&quot;</span>:<span class="string">&quot;01::01::2016&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Tests"><a href="#Tests" class="headerlink" title="Tests"></a>Tests</h3><p>When we define custom serializer, our tests start to fail. It is because RestTemplate knows nothing about our deserializer. We have to create custom RestTemplateFactory that creates RestTemplate with object mapper containing our deserializer.</p>
<figure class="highlight java"><figcaption><span>Custom RestTemplateFactory</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ObjectMapper objectMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">createRestTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">RestTemplate</span> <span class="variable">restTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">        List&lt;HttpMessageConverter&lt;?&gt;&gt; converters = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">MappingJackson2HttpMessageConverter</span> <span class="variable">jsonConverter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>();</span><br><span class="line">        jsonConverter.setObjectMapper(objectMapper);</span><br><span class="line">        converters.add(jsonConverter);</span><br><span class="line">        restTemplate.setMessageConverters(converters);</span><br><span class="line">        <span class="keyword">return</span> restTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Custom formatting Dates is relatively simple, but you have to know how to set up it. Luckily, <code>Jackson</code> works smoothly with <code>Spring</code>. If you know other ways of solving this problem or you have other observations, please comment or let me know.</p>
<p>Photo credits: <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/19511776@N00/286814746">Banner</a>, <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/49968232@N00/2474880917">Thumbnail</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2016-01-02T11:30:00.000Z" title="1/2/2016, 12:30:00 PM">2016-01-02</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">12 minutes read (About 1763 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2016/01/clojure-summary/">Clojure - Fascinated, Disappointed, Astonished</a></p><div class="content"><p><strong>I’ve had a pleasure to work with <a target="_blank" rel="noopener" href="http://pjagielski.pl/">Piotrek Jagielski</a> for about two weeks on Clojure project. I’ve learned a lot, but there is still a lot to know about Clojure for me. In this post I’ll write what fascinated, disappointed and astonished me about this programming language.</strong></p>
<h5 id="Clojure-InteliJ-IDEA-tips"><a href="#Clojure-InteliJ-IDEA-tips" class="headerlink" title="Clojure &amp; InteliJ IDEA tips"></a>Clojure &amp; InteliJ IDEA tips</h5><p>Before you start your journey with Clojure:</p>
<ul>
<li>Use <a target="_blank" rel="noopener" href="https://cursiveclojure.com/userguide/">Cursive plugin</a> for InteliJ IDEA. In ‘14 Edition it was not in the standard plug-in repository (remove La Clojure plug-in and Cursive repository manually). For IDEA ‘15 it is in repository.</li>
<li>Colored brackets help me a lot. You can find configuration for colored brackets on <a target="_blank" rel="noopener" href="https://github.com/Misophistful/borealis-cursive-theme">Misophistful Github</a>.</li>
</ul>
<h3 id="Fascinated"><a href="#Fascinated" class="headerlink" title="Fascinated"></a>Fascinated</h3><h5 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h5><p>For many people Clojure brackets are reasons to laugh. Jokes like that were funny at first: “How many brackets did you write today?”<br>I have to admit, that at the beginning using brackets was not easy for me. Once I’ve realized that the brackets are just on the other side of the function name, everything was simple and I could code very fast.<br>After few days I’ve realized that this brackets structure forces me to think more about the structure of the code. As a result the code is refactored and divided into small functions.<br>Clojure forces you to use good programming habits.</p>
<h5 id="Data-structure-is-your-code"><a href="#Data-structure-is-your-code" class="headerlink" title="Data structure is your code"></a>Data structure is your code</h5><p>Clojure is <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Homoiconicity">homoiconic</a>, which means that the Clojure programs are represented by Clojure data structures. This means that when you are reading a Clojure code you see lists, maps, vectors. How cool is that! You only have to know few things and you can code.</p>
<h5 id="Do-not-restart-your-JVM"><a href="#Do-not-restart-your-JVM" class="headerlink" title="Do not restart your JVM"></a>Do not restart your JVM</h5><p>Because Clojure code is represented as data structures, you can pass data structure (program) to running JVM. Furthermore, compiling your code to bytecode (classes, jars) may be eliminated. </p>
<p> For example, when you want to test something you are not obligated to start new JVM with tests. Instead you can just synchronize your working file with running REPL and run the function.</p>
<p> Traditional way of working with JVM is obsolete.</p>
<p><img src="/images/clojure-repl.png" alt="REPL code synchronization"></p>
<p>In the picture above, on the left you can see an editor, on the right there is running REPL.</p>
<p>The same way you can run tests, which is extremely fast. In our project we had ~80 tests. Executing them all took about one second.</p>
<h5 id="Easy-to-read"><a href="#Easy-to-read" class="headerlink" title="Easy to read"></a>Easy to read</h5><blockquote><p>Simplicity is the ultimate sophistication.</p>
<footer><strong>Leonardo da Vinci</strong></footer></blockquote>
<p>After getting familiar with this language, it was really easy to read code. Of course, I was not aware of everything what was happening under the hood, but consistency of the written program evoked sense of control.</p>
<h3 id="Disapointed"><a href="#Disapointed" class="headerlink" title="Disapointed"></a>Disapointed</h3><h5 id="Data-structure-is-your-code-1"><a href="#Data-structure-is-your-code-1" class="headerlink" title="Data structure is your code"></a>Data structure is your code</h5><p>When data structure is your code, you need to have some additional operators to write effective programs. You should get to know operators like ‘-&gt;&gt;’, ‘-&gt;’, ‘let’, ‘letfn’, ‘do’, ‘if’, ‘recur’ …</p>
<p>Even if there is a good documentation (e.g. <a target="_blank" rel="noopener" href="https://clojuredocs.org/clojure.core/let">Let</a>), you have to spend some time on analyzing it, and trying out examples. </p>
<p>As the time goes on, new operators will be developed. But it may lead to multiple Clojure dialects. I can imagine teams (in the same company) using different sets of operators, dealing with the same problems in different ways. It is not good to have too many tools. Nevertheless, this is just my suspicion.</p>
<h5 id="Know-what-you-do"><a href="#Know-what-you-do" class="headerlink" title="Know what you do"></a>Know what you do</h5><p>I’ve written a function that rounds numbers. Despite the fact that this function was simple, I wanted to write test, because I was not sure if I had used the API in correct way. There is the test function below:</p>
<figure class="highlight clojure"><figcaption><span>Rounding test</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="built_in">let</span></span> [result (<span class="name">fixture/round</span> <span class="number">8.211M</span>)]</span><br><span class="line">  (<span class="name">is</span> (<span class="name"><span class="built_in">=</span></span> <span class="number">8.21M</span> result))))</span><br></pre></td></tr></table></figure>
<p>Unfortunately, tests were not passing. This is the only message that I received:</p>
<figure class="highlight clojure"><figcaption><span>Rounding test</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">:error-while-loading</span> pl.package.calc-test</span><br><span class="line">NullPointerException   [trace missing]</span><br><span class="line">(<span class="name">pst</span>)</span><br><span class="line">NullPointerException</span><br></pre></td></tr></table></figure>
<p>Great. There is nothing better than a good exception error. I’ve spent a lot of time trying to solve this, and solution was extremely simple.<br>My function was defined with <code>defn-</code>, instead of <code>defn</code>. <code>defn-</code> means private scope and test code, could not access testing function.</p>
<h5 id="Do-not-trust-assertions"><a href="#Do-not-trust-assertions" class="headerlink" title="Do not trust assertions"></a>Do not trust assertions</h5><p>Assertions can be misleading. When tested code does not work properly and returns wrong results, error messages are like this: </p>
<figure class="highlight clojure"><figcaption><span>Assertions problems</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ERROR in math-test/math-operation-test (<span class="name">RT.java:528</span>)</span><br><span class="line">should round using half up</span><br><span class="line">expected: (<span class="name"><span class="built_in">=</span></span> <span class="number">8.31M</span> result)</span><br><span class="line"> actual: java.lang.IllegalArgumentException: Don&#x27;t know how to create ISeq from: java.math.BigDecimal</span><br></pre></td></tr></table></figure>
<p>I hadn’t got time to investigate it, but in my opinion it should work out of the box.</p>
<h5 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h5><p>It is a matter of time, when tools will be better. Those problems will slow you down, and they are not nice to work with.</p>
<h3 id="Astonished"><a href="#Astonished" class="headerlink" title="Astonished"></a>Astonished</h3><p>The Clojure concurrency impressed me. Until then, I knew only standard Java synchronization model and Scala actors model. I’ve never though that concurrency problems can be solved in a different way. I will explain Clojure approach to concurrency, in details.</p>
<h4 id="Normal-variables"><a href="#Normal-variables" class="headerlink" title="Normal variables"></a>Normal variables</h4><p>The closest Clojure’s analogy to the variables are <code>vars</code>, which can be created by <code>def</code>.</p>
<figure class="highlight clojure"><figcaption><span>Vars</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">a01</span> []</span><br><span class="line">  (<span class="keyword">def</span> <span class="title">amount</span> <span class="number">10</span>)</span><br><span class="line">  (<span class="keyword">def</span> <span class="title">amount</span> <span class="number">100</span>)</span><br><span class="line">  (<span class="name">println</span> amount))</span><br></pre></td></tr></table></figure>

<p>We also have local variables which are only in <code>let</code> scope. If we re-define scope value of amount, the change will take place only in local context.</p>
<figure class="highlight clojure"><figcaption><span>Lets</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">a02</span> []</span><br><span class="line">  (<span class="name"><span class="built_in">let</span></span> [amount <span class="number">10</span>]</span><br><span class="line">    (<span class="name"><span class="built_in">let</span></span> [amount <span class="number">100</span>]</span><br><span class="line">      (<span class="name">println</span> amount))</span><br><span class="line">    (<span class="name">println</span> amount)))</span><br></pre></td></tr></table></figure>

<p>The following will print:</p>
<figure class="highlight clojure"><figcaption><span>Lets output</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">100</span></span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>Nothing unusual. We might expect this behavior.</p>
<h3 id="Concurrent-access-variables"><a href="#Concurrent-access-variables" class="headerlink" title="Concurrent access variables"></a>Concurrent access variables</h3><p>The whole idea of concurrent access variables can be written in one sentence. Refs ensures safe shared access to variables via STM, where mutation can only occur via transaction.<br>Let me explain it step by step.</p>
<h5 id="What-is-Refs"><a href="#What-is-Refs" class="headerlink" title="What is Refs?"></a>What is Refs?</h5><p>Refs (reference) is a special type to hold references to your objects. As you can expect, basic things you can do with it is storing and reading values.</p>
<h5 id="What-is-STM"><a href="#What-is-STM" class="headerlink" title="What is STM?"></a>What is STM?</h5><p>STM stands for <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Software_transactional_memory">Software Transactional Memory</a>. STM is an alternative to lock-based synchronization system. If you like theory, please continue with Wikipedia, otherwise continue reading to see examples.</p>
<h4 id="Using-Refs"><a href="#Using-Refs" class="headerlink" title="Using Refs"></a>Using Refs</h4><figure class="highlight clojure"><figcaption><span>Refs reads</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">a03</span> []</span><br><span class="line">  (<span class="keyword">def</span> <span class="title">amount</span> (<span class="name"><span class="built_in">ref</span></span> <span class="number">10</span>))</span><br><span class="line">  (<span class="name">println</span> @amount))</span><br></pre></td></tr></table></figure>
<p>In the second line, we are creating reference. Name of this reference is <code>amount</code>. Current value is <code>10</code>.<br>In the third line, we are reading value of the reference called <code>amount</code>. Printed result is 10.</p>
<h4 id="Modifying-Refs-without-transaction"><a href="#Modifying-Refs-without-transaction" class="headerlink" title="Modifying Refs without transaction"></a>Modifying Refs without transaction</h4><figure class="highlight clojure"><figcaption><span>Refs writes without transaction</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">a04</span> []</span><br><span class="line">  (<span class="keyword">def</span> <span class="title">amount</span> (<span class="name"><span class="built_in">ref</span></span> <span class="number">10</span>))</span><br><span class="line">  (<span class="name"><span class="built_in">ref-set</span></span> amount <span class="number">100</span>)</span><br><span class="line">  (<span class="name">println</span> @amount))</span><br></pre></td></tr></table></figure>
<p>Using ref-set command, we modify the value of the reference amount to the value 100. But it won’t work. Instead of that we caught exception:</p>
<figure class="highlight clojure"><figcaption><span>Exception</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IllegalStateException No transaction running  clojure.lang.LockingTransaction.getEx (<span class="name">LockingTransaction.java:208</span>)</span><br></pre></td></tr></table></figure>


<h4 id="Using-transaction"><a href="#Using-transaction" class="headerlink" title="Using transaction"></a>Using transaction</h4><figure class="highlight clojure"><figcaption><span>Refs writes with transaction</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">a05</span> []</span><br><span class="line">  (<span class="keyword">def</span> <span class="title">amount</span> (<span class="name"><span class="built_in">ref</span></span> <span class="number">10</span>))</span><br><span class="line">  (<span class="name"><span class="built_in">dosync</span></span> (<span class="name"><span class="built_in">ref-set</span></span> amount <span class="number">100</span>))</span><br><span class="line">  (<span class="name">println</span> @amount))</span><br></pre></td></tr></table></figure>
<p>To modify the code we have to use <code>dosync</code> operation. By using it, we create transaction and only then the referenced value will be changed.</p>
<h4 id="Complete-example"><a href="#Complete-example" class="headerlink" title="Complete example"></a>Complete example</h4><p>The aim of the previous examples was to get familiar with the new operators and basic behavior.<br>Below, I’ve prepared an example to illustrate bolts and nuts of STM, transactions and rollbacks.</p>
<h5 id="The-problem"><a href="#The-problem" class="headerlink" title="The problem"></a>The problem</h5><p>Imagine we have two references for holding data:</p>
<ul>
<li><code>source-vector</code> containing three elements: “A”, “B” and “C”.</li>
<li>empty <code>destination-vector</code>.</li>
</ul>
<p>Our goal is to copy the whole source vector to destination vector. Unfortunately, we can only use function which can copy elements one by one - <code>copy-vector</code>. </p>
<p>Moreover, we have three threads that will do the copy. Threads are started by the <code>future</code> function.</p>
<p>Keep in mind that this is probably not the best way to copy vectors, but it illustrates how STM works.</p>
<figure class="highlight clojure"><figcaption><span>Refs writes with transaction</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">copy-vector</span> [source destination]</span><br><span class="line">  (<span class="name"><span class="built_in">dosync</span></span></span><br><span class="line">    (<span class="name"><span class="built_in">let</span></span> [head (<span class="name"><span class="built_in">take</span></span> <span class="number">1</span> @source)</span><br><span class="line">          tail (<span class="name"><span class="built_in">drop</span></span> <span class="number">1</span> @source)</span><br><span class="line">          conj (<span class="name"><span class="built_in">concat</span></span> head @destination)]</span><br><span class="line">      (<span class="name"><span class="built_in">do</span></span></span><br><span class="line">        (<span class="name">println</span> <span class="string">&quot;Trying to write destination ... &quot;</span>)</span><br><span class="line">        (<span class="name"><span class="built_in">ref-set</span></span> destination conj)</span><br><span class="line">        (<span class="name">println</span> <span class="string">&quot;Trying to write source ... &quot;</span>)</span><br><span class="line">        (<span class="name"><span class="built_in">ref-set</span></span> source tail)</span><br><span class="line">        (<span class="name">println</span> <span class="string">&quot;Sucessful write &quot;</span> @destination)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">a06</span> []</span><br><span class="line">  (<span class="name"><span class="built_in">let</span></span> [source-vector (<span class="name"><span class="built_in">ref</span></span> [<span class="string">&quot;A&quot;</span> <span class="string">&quot;B&quot;</span> <span class="string">&quot;C&quot;</span>]) destination-vector (<span class="name"><span class="built_in">ref</span></span> [])]</span><br><span class="line">    (<span class="name"><span class="built_in">do</span></span></span><br><span class="line">      (<span class="name"><span class="built_in">future</span></span> (<span class="name">copy-vector</span> source-vector destination-vector))</span><br><span class="line">      (<span class="name"><span class="built_in">future</span></span> (<span class="name">copy-vector</span> source-vector destination-vector))</span><br><span class="line">      (<span class="name"><span class="built_in">future</span></span> (<span class="name">copy-vector</span> source-vector destination-vector))</span><br><span class="line">      (<span class="name">Thread/sleep</span> <span class="number">500</span>)</span><br><span class="line">      @destination-vector</span><br><span class="line">      )))</span><br></pre></td></tr></table></figure>

<h5 id="Execution"><a href="#Execution" class="headerlink" title="Execution"></a>Execution</h5><p>Below is the output of this function. We can clearly see that the result is correct. Destination vector has three elements. Between <code>Sucessful write</code> messages we can see that there are a lot of messages starting with <code>Trying to write</code>.<br>What does it mean? The rollback and retry occurred.</p>
<figure class="highlight plaintext"><figcaption><span>Printed messageslang:Clojure</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(l/a06)</span><br><span class="line">Trying to write destination ...</span><br><span class="line">Trying to write source ... </span><br><span class="line">Trying to write destination ...</span><br><span class="line">Trying to write destination ... </span><br><span class="line">Sucessful write (A)</span><br><span class="line">Trying to write destination ...</span><br><span class="line">Trying to write destination ...</span><br><span class="line">Trying to write source ...</span><br><span class="line">Sucessful write  (B A)</span><br><span class="line">Trying to write destination ...</span><br><span class="line">Trying to write source ...</span><br><span class="line">Sucessful write  (C B A)</span><br><span class="line">=&gt; (&quot;C&quot; &quot;B&quot; &quot;A&quot;)</span><br></pre></td></tr></table></figure>

<h5 id="Rollback"><a href="#Rollback" class="headerlink" title="Rollback"></a>Rollback</h5><p>Each thread started to copy this vector, but only one succeed. The remaining two threads had to rollback work and try again one more time.</p>
<p><img src="/images/stm-rollback.png" alt="Software Transaction Memory"></p>
<p>When <code>Thread A</code> (red one) wants to write variable, it notices that the value has been changed by someone else - conflict occurs. As a result, it stops the current work and tries again whole section of <code>dosync</code>. It will try until every write operation succeed.</p>
<h4 id="Pros-and-cons-of-STM"><a href="#Pros-and-cons-of-STM" class="headerlink" title="Pros and cons of STM"></a>Pros and cons of STM</h4><p>Cons:</p>
<ul>
<li>Everything that happens in <code>dosync</code> section has to be pure, without side effects. For example you can not send email to someone, because you might send 10 emails instead of one.  </li>
<li>From performance perspective, it makes sense when you are reading a lot from Refs, but rarely writing it.</li>
</ul>
<p>Pros:</p>
<ul>
<li>Written code is easy to read, understand, modify.</li>
<li>Refs and transactions are part of standard library, so you can use it in Vanilla Java. Take a look at this <a target="_blank" rel="noopener" href="http://www.lispcast.com/3-things-java-can-steal-from-clojure">blog post</a> for more examples.</li>
</ul>
<h3 id="Summary-1"><a href="#Summary-1" class="headerlink" title="Summary"></a>Summary</h3><p>There is a lot that Java developers can gain from Clojure. They can learn how to approach the code and how to express the problem in the code. Also they can discover tools like STM.</p>
<p>If you like to develop your skills, you should definitely experiment with Clojure.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2015-11-26T08:48:00.000Z" title="11/26/2015, 9:48:00 AM">2015-11-26</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">3 minutes read (About 507 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2015/11/clojure-time/">Clojure - How to replace current time creation?</a></p><div class="content"><p>Recently, I’ve begun my adventure with Clojure programming language. As a result I’ve decided to share gathered knowledge and my opinion, in this and in few upcoming posts.</p>
<h2 id="The-problem"><a href="#The-problem" class="headerlink" title="The problem"></a>The problem</h2><p>I had to implement algorithm that depends on the current date. Core information for this algorithm is number of days between current date and some date in the future, expressed in days.<br>Therefore, there is a call somewhere in the code:</p>
<figure class="highlight clojure"><figcaption><span>Current time with Java 8</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="built_in">.</span></span> java.time.LocalDate now)</span><br></pre></td></tr></table></figure>
<p>For the tests to be stable, I had to make sure that this call always return the same day.</p>
<h2 id="Approach-1"><a href="#Approach-1" class="headerlink" title="Approach 1"></a>Approach 1</h2><p>I’ve decided to extract creation of the current date functionality to the function:</p>
<figure class="highlight clojure"><figcaption><span>now-date function will return current time</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">now-date</span> [] (<span class="name"><span class="built_in">.</span></span> java.time.LocalDate now))</span><br></pre></td></tr></table></figure>
<p>During tests I’ve declared different function:</p>
<figure class="highlight clojure"><figcaption><span>fixed-date function will return current time</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">fixed-date</span> [] (<span class="name"><span class="built_in">.</span></span> java.time.LocalDate of <span class="number">2015</span> <span class="number">01</span> <span class="number">28</span>))</span><br></pre></td></tr></table></figure>
<p>Passing function that creates a current date, solved the problem. It worked great, but it had the following disadvantages:</p>
<ul>
<li>Passing to algorithm function that creates current time.</li>
<li>Using java notation (with dot) in Clojure.</li>
</ul>
<h2 id="Approach-2"><a href="#Approach-2" class="headerlink" title="Approach 2"></a>Approach 2</h2><p>Having a function, that returns a current time, I’ve decided to find a way of overwriting its definition in tests. I’ve found out that there is operation called <code>with-redefs-fn</code>, which allows re-defining the function temporarily in the local context. Having defined fixed-date function, block of code looks like this:</p>
<figure class="highlight clojure"><figcaption><span>Replacing now-date with fixed-date</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">deftest</span> my-test</span><br><span class="line">  (<span class="name">with-redefs-fn</span> &#123; #&#x27;fixture/now-date fixed-date &#125;</span><br><span class="line">   #(<span class="name"><span class="built_in">do</span></span>     </span><br><span class="line">     (<span class="name">testing</span> <span class="string">&quot;should work method a&quot;</span>        </span><br><span class="line">       (<span class="name"><span class="built_in">let</span></span> [result (<span class="name">fixture/do-stuff</span> <span class="number">30</span>)]</span><br><span class="line">         (<span class="name">is</span> (<span class="name">.equals</span> <span class="number">8.22M</span> result))</span><br><span class="line">         ))</span><br><span class="line">     <span class="comment">;More tests</span></span><br><span class="line">         )))</span><br></pre></td></tr></table></figure>

<p><code>fixture/now-date</code> is a reference to function that I wanted to replace. This time I was amazed by language possibilities. But there was one more problem to solve. I did not want to use java notation.</p>
<h2 id="Approach-3"><a href="#Approach-3" class="headerlink" title="Approach 3"></a>Approach 3</h2><p>There is a library called <a target="_blank" rel="noopener" href="https://github.com/clj-time/clj-time">Clj-time</a>. It wraps Joda Time library and makes Clojure code more friendly. I wanted to hold on Java 8 library, but I did not see any alternatives. </p>
<p>So I replaced <code>(. java.time.LocalDate now)</code> to <code>(t/now)</code> and also creation of fixed dates, and then I came up with an idea.</p>
<h2 id="Approach-4"><a href="#Approach-4" class="headerlink" title="Approach 4"></a>Approach 4</h2><p>Maybe should I replace the Clj-time itself? My production code will be simpler and the test code will be simpler too!</p>
<figure class="highlight clojure"><figcaption><span>Replacing t/now with fixed date</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">deftest</span> my-test</span><br><span class="line"> (<span class="name">with-redefs-fn</span> &#123; #&#x27;t/now #(<span class="name">t/date-time</span> <span class="number">2015</span> <span class="number">11</span> <span class="number">19</span>) &#125;</span><br><span class="line">   #(<span class="name"><span class="built_in">do</span></span>     </span><br><span class="line">     (<span class="name">testing</span> <span class="string">&quot;should work method a&quot;</span>        </span><br><span class="line">        (<span class="name"><span class="built_in">let</span></span> [result (<span class="name">fixture/do-stuff</span> <span class="number">30</span> <span class="number">1000</span>)]</span><br><span class="line">         (<span class="name">is</span> (<span class="name">.equals</span> <span class="number">8.22M</span> result))</span><br><span class="line">         ))</span><br><span class="line">     <span class="comment">;More tests </span></span><br><span class="line">         )))</span><br></pre></td></tr></table></figure>
<p>This is my final solution. I am still impressed how easily it that can be done.</p>
<p>I use Clojure for a week. If you have any other ideas how to solve this problem comment, let me know.</p>
<p>Photo credit: <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/10278395@N08/4156310480">Vintage alarm clock</a>, <a target="_blank" rel="noopener" href="http://www.flickr.com/photos/134465805@N06/21623729612">Thumbnail</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2015-04-17T15:23:00.000Z" title="4/17/2015, 5:23:00 PM">2015-04-17</time></span><span class="level-item"><a class="link-muted" href="/categories/Software-Development/">Software Development</a></span><span class="level-item">a few seconds read (About 36 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2015/04/upgrade-docker-16/">How to upgrade docker to 1.6.0 on OSX via homebrew</a></p><div class="content"><p>So simple, but few my friends has problem with this. The key point is to perform boot2docker upgrade which upgrade ISO image.  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew update </span><br><span class="line">brew upgrade boot2docker</span><br><span class="line">boot2docker upgrade</span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/categories/Software-Development/page/0/">Previous</a></div><div class="pagination-next"><a href="/categories/Software-Development/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/categories/Software-Development/">1</a></li><li><a class="pagination-link" href="/categories/Software-Development/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/images/theme/logo.png" alt="Michał Lewandowski"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Michał Lewandowski</p><p class="is-size-6 is-block">Engineering Manager</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Europe, Warsaw Poland</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">42</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">44</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://www.linkedin.com/in/lewandowski-io/" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/mlevvy"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/lewandowski.michal/"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/lewandm4"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/lewandowski-io/"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Book/"><span class="level-start"><span class="level-item">Book</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Event/"><span class="level-start"><span class="level-item">Event</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Software-Development/"><span class="level-start"><span class="level-item">Software Development</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/Technology/"><span class="level-start"><span class="level-item">Technology</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Management/"><span class="tag">Management</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Agile/"><span class="tag">Agile</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OS-X/"><span class="tag">OS X</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Devoxx/"><span class="tag">Devoxx</span><span class="tag">2</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="https://api.follow.it/subscription-form/SCtIS1IzbmIzZjVnTjhYb1p5VDFDajBxWkhVakxja1NkTFNjejYxR1BoMWw0aGloSTMxRThrd0ZRRzFpRFBkQXRqYWVyWko1Y3Q2cExzUkdxMDgvbUxDelhDS0lpK3AyVnllK21MVXRFWC84ZXo5KzYvZUN3bzFoRThrUnZFdnJ8Rm9CT25jaXpobHJZS0NJRXVQdDBPcnJMUE82YlM3MVE1eEhEVk5oOGRCND0=/8" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/2024/01/7-levels-of-initives/"><img src="/images/blog/7levelsinitiative-thumbnail.png" alt="Unlocking Team Potential - The 7 Levels of Initiative"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-01-03T13:00:00.000Z">2024-01-03</time></p><p class="title"><a href="/2024/01/7-levels-of-initives/">Unlocking Team Potential - The 7 Levels of Initiative</a></p><p class="categories"><a href="/categories/Software-Development/">Software Development</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2023/10/communication-written/"><img src="/images/blog/communication-written-thumbnail.jpg" alt="The Engineering Manager&#039;s 10-Step Blueprint for Effective Written Communication"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-10-03T17:16:17.000Z">2023-10-03</time></p><p class="title"><a href="/2023/10/communication-written/">The Engineering Manager&#039;s 10-Step Blueprint for Effective Written Communication</a></p><p class="categories"><a href="/categories/Software-Development/">Software Development</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2023/08/output-vs-outcome/"><img src="/images/blog/output_vs_outcome-thumbnail.jpg" alt="Outcome vs Output in Software Engineering - A Critical Balance"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-08-20T14:48:22.000Z">2023-08-20</time></p><p class="title"><a href="/2023/08/output-vs-outcome/">Outcome vs Output in Software Engineering - A Critical Balance</a></p><p class="categories"><a href="/categories/Software-Development/">Software Development</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2020/04/se-roadmap/"><img src="/images/blog/se-map-thumbnail.jpg" alt="Software Engineer Checklist"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-04-03T09:00:00.000Z">2020-04-03</time></p><p class="title"><a href="/2020/04/se-roadmap/">Software Engineer Checklist</a></p><p class="categories"><a href="/categories/Software-Development/">Software Development</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2020/01/best-books-in-2019/"><img src="/images/blog/books-thumbnail.jpg" alt="Two best books in 2019"></a></figure><div class="media-content"><p class="date"><time dateTime="2020-01-21T19:46:00.000Z">2020-01-21</time></p><p class="title"><a href="/2020/01/best-books-in-2019/">Two best books in 2019</a></p><p class="categories"><a href="/categories/Book/">Book</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/"><span class="level-start"><span class="level-item">2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/"><span class="level-start"><span class="level-item">2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/"><span class="level-start"><span class="level-item">2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/"><span class="level-start"><span class="level-item">2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/"><span class="level-start"><span class="level-item">2016</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/"><span class="level-start"><span class="level-item">2015</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/"><span class="level-start"><span class="level-item">2014</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/"><span class="level-start"><span class="level-item">2013</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/"><span class="level-start"><span class="level-item">2012</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2011/"><span class="level-start"><span class="level-item">2011</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1544756215319337" data-ad-slot="1495263777" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/theme/logo.png" alt="Beyond the Blueprint" height="28"></a><p class="is-size-7"><span>&copy; 2024 Michał Lewandowski</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>